#summary Gives a step by step tutorial taking you from the start to end of deploying an Easyshop inside a standard Plone installation
#labels Featured,Phase-Deploy
#sidebar TableOfContents

= Prerequisites: =
  # A standard buildout based installation of [http://www.plone.org/ Plone]. We tested on Plone v3.3.4.
  # [http://subversion.tigris.org/ Subversion] installed. On Unices such as Debian Linux et al, this is easiest installed using something like `apt-get install subversion`.
  # You probably need root access on your deployment machine.
  # And you really, _really_ ought to test this on a local test machine first in case something really bad happens. We personally run [http://www.virtualbox.org/ VirtualBox] based copies of our internet services which we synchronise using a 1-to-1 rsync, so it lets us play and undo any damage we do with real server copies (it also acts as a convenient backup which can always be rsynced the other way if needs be).

Be aware that some parts of Easyshop is of alpha code quality at present: it generally mostly works, but there are occasional bugs and glitches most of which are listed on [http://code.google.com/p/easyshop-for-plone/issues/list the issue tracker]. I personally ([http://code.google.com/u/nialldouglas14/ Niall Douglas]) will happily fix any bugs you find in the Paypal payment deployment only as it's the only one I use myself and my business depends upon, and I would judge the Paypal payment deployment to be of beta quality approaching deployment quality. You can of course pay [http://code.google.com/p/easyshop-for-plone/people/list any of the contributors to Easyshop] to improve things that you particularly need.

= Installation: =
Your Plone installation is probably in something like `/usr/local/Plone/zeocluster` if you used the default settings for a ZEO deployment, so we'll assume that. Firstly you need a copy of SVN HEAD of Easyshop as it is still at beta quality, and you'll probably find a bug we haven't as it always seems to be, so as root:

{{{
cd /usr/local/Plone/zeocluster/src
svn checkout https://svn.plone.org/svn/archetypes/Products.DataGridField/trunk DataGridField-1.7
svn checkout http://easyshop-for-plone.googlecode.com/svn/buildout/3.0-Anonymous/ easyshop.buildout
}}}

Leave that run till it's done, then:

{{{
cd ..
nano buildout.cfg
}}}

We now need to add a lot of easyshop stuff to the buildout process, so:

{{{
eggs =
    ...
    easyshop.core
    easyshop.carts
    easyshop.catalog
    easyshop.checkout
    easyshop.criteria
    easyshop.customers
    easyshop.discounts
    easyshop.groups
    easyshop.information
    easyshop.kss
    easyshop.login
    easyshop.management
    easyshop.order
    easyshop.payment
    easyshop.shipping
    easyshop.shop
    easyshop.stocks
    easyshop.taxes
    Products.DataGridField
    ...

zcml =
    ...
    easyshop.core
    easyshop.carts
    easyshop.catalog
    easyshop.checkout
    easyshop.criteria
    easyshop.customers
    easyshop.discounts
    easyshop.groups
    easyshop.information
    easyshop.kss
    easyshop.login
    easyshop.management
    easyshop.order
    easyshop.payment
    easyshop.shipping
    easyshop.shop
    easyshop.stocks
    easyshop.taxes
    ...

develop =
    ...
    src/DataGridField-1.7
    src/easyshop.buildout/src/easyshop.core
    src/easyshop.buildout/src/easyshop.carts
    src/easyshop.buildout/src/easyshop.catalog
    src/easyshop.buildout/src/easyshop.checkout
    src/easyshop.buildout/src/easyshop.criteria
    src/easyshop.buildout/src/easyshop.customers
    src/easyshop.buildout/src/easyshop.discounts
    src/easyshop.buildout/src/easyshop.groups
    src/easyshop.buildout/src/easyshop.information
    src/easyshop.buildout/src/easyshop.kss
    src/easyshop.buildout/src/easyshop.login
    src/easyshop.buildout/src/easyshop.management
    src/easyshop.buildout/src/easyshop.order
    src/easyshop.buildout/src/easyshop.payment
    src/easyshop.buildout/src/easyshop.shipping
    src/easyshop.buildout/src/easyshop.shop
    src/easyshop.buildout/src/easyshop.stocks
    src/easyshop.buildout/src/easyshop.taxes
    ...

# You probably want this on:
debug-mode = on
}}}

The need for DataGridField as source rather than egg is because the latest version in the egg repos is Plone 4 only and Plone 3.x will puke with it. Thus you can either pin the version or keep a src copy from subversion - I just tend to prefer the latter as I find it less prone to buildout -n suddenly breaking everything.

Lastly:
{{{
cd products
ln -s ../src/easyshop.buildout/products/EasyShopTranslations EasyShopTranslations
cd ..
bin/buildout
}}}

You should now be ready to run, but if you want a currency other than Euro, British Sterling and US Dollars then you need to do one more thing:

{{{
nano src/easyshop.buildout/src/easyshop.core/easyshop/core/config.py
}}}

Here you can adjust various parameters for Easyshop, so if you want an extra currency you simply add it to the CURRENCIES section. You may also wish to edit VAT_COUNTRIES if you don't live in the EU, and DEFAULT_COUNTRIES if the countries you wish to deliver to aren't in the EU or USA. Lastly at the bottom is the all important PAYPAL_URL which lets you choose the Paypal Sandbox which is absolutely essential for testing that the shop absolutely & definitely will work with your customers in every conceivable scenario (e.g. if they are rejected, or they are using a stolen credit card etc).

= Running Zope directly: =
Personally I find that running Zope directly instead of using bin/plonectl is the easiest for debugging, so do:

{{{
parts/zeoserver/bin/runzeo &
parts/client1/bin/runzope &
}}}

... to start and a simple `killall python` to stop. This method prints all debug output to the terminal so you can see exception backtraces and such: very useful.

= Creating an Easyshop instance: =
Get into the ZMI and create a Plone site - you probably don't want to do this first time with an existing site until you've familiarised yourself with Easyshop's quirks. Once in the site, go to portal_quickinstaller or View/Site Setup/Add-on Products and add the Easyshop product.

Now you'll get an "Easyshop" item in the Add New drop down menu. So go ahead and add an Easyshop, giving it a title of "Shop" and a Shop Owner of whatever you want to appear on your product invoices. On the Misc tab most options are fairly self explanatory, but to clarify some of them you can choose "Gross Prices" if all the product prices you enter already include taxes, but for most people it's easiest to leave this turned off. If you are VAT registered and wish to allow VAT registered entities not in your local economy to have your local VAT rate removed, you can choose your local VAT country ID so Easyshop knows when it ought to charge VAT or not. Lastly, if you want Paypal as a payment option, you MUST fill in the Paypal account email address on the Payment tab.

So there you have it: your first Easyshop shop! After publishing it you ought to test it with an anonymous browser (i.e. one not logged in). I personally use IE8 for that as I never use IE for anything else :)

= Creating your first category and product: =
Easyshop uses categories to group products for your customers, whereas it uses groups to group products for you the admin only. Hence you always need at least one category.

Before creating a category, you firstly need a Product to go into it. Click on Products in the Manager menu and do Add New/Product. Give it a Title of "Widget", a description, image and base price (say 100). Choosing the Advanced tab lets you choose Stock Amount, whether the stock is unlimited (for say an electronic good or service), whether the item is for sale and its sale price, whether it has accessories and so on. Choosing the Size tab lets you enter the all important weight and box dimensions which are so crucial to calculating Shipping. Give it a stock amount of 5 and a weight of 10kg, then hit Save.

Next we'll add some product options. Choose Product Properties and type "Case" and add the property. In the new Case field type "Gold Plated" in the Title field and type 50 into its price before hitting Add. Return to the view, and don't forget to publish it.

In the Easyshop view, choose Categories from the Manager menu on the left. Type something like "Appliances" into the box and click on Add Category. Next c